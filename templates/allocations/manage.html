{% extends "base.html" %}

{% block title %}Manage Allocations - Event Scheduler{% endblock %}

{% block content %}
<div class="card">
    <h2>Allocate Resources to Events</h2>

    <form method="POST" action="{{ url_for('add_allocation') }}">
        {{ form.hidden_tag() }}

        <div class="form-group">
            {{ form.event_id.label }}
            {{ form.event_id(class="form-control") }}
        </div>

        <div class="form-group">
            {{ form.resource_ids.label }}
            {{ form.resource_ids(class="form-control") }}
            <small>Hold Ctrl/Cmd to select multiple resources</small>
        </div>

        <button type="submit" class="btn">Allocate Resources</button>
    </form>
</div>

<div class="card">
    <h2>Current Allocations</h2>

    {% if allocations %}
    <table>
        <thead>
            <tr>
                <th>Event</th>
                <th>Resource</th>
                <th>Event Time</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for allocation in allocations %}
            <tr>
                <td><strong>{{ allocation.event.title }}</strong></td>
                <td>{{ allocation.resource.resource_name }} ({{ allocation.resource.resource_type }})</td>
                <td>{{ allocation.event.start_time.strftime('%Y-%m-%d %H:%M') }} - {{
                    allocation.event.end_time.strftime('%H:%M') }}</td>
                <td>
                    <a href="{{ url_for('delete_allocation', allocation_id=allocation.allocation_id) }}"
                        class="btn btn-small btn-danger" onclick="return confirm('Remove this allocation?')">Remove</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="no-data">No allocations yet. Allocate resources to events above.</p>
    {% endif %}
</div>
{% endblock %}